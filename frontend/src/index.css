@tailwind base;
@tailwind components;
@tailwind utilities;

/* =========================
   外观系统（设计 Token）
   说明：用 CSS 变量承载主题色/深色/毛玻璃等视觉基建。
   后续功能（包括拓展系统）只要用这些变量/类名，就能自动适配。
   ========================= */

:root {
  /* 基础色（RGB 三元组，配合 Tailwind 的 /<alpha-value> 使用） */
  --bg: 255 255 255;
  --fg: 15 23 42; /* slate-900 */

  /* 主题色（可被设置面板动态修改） */
  --primary: 59 130 246; /* blue-500 */
  --primary-fg: 255 255 255;

  /* 毛玻璃表面 */
  --glass: 255 255 255;
  --glass-border: 255 255 255;

  /* 全局圆角（可在设置里调节） */
  --start-radius: 18px;
}

.dark {
  --bg: 2 6 23; /* slate-950 */
  --fg: 241 245 249; /* slate-100 */

  --glass: 2 6 23;
  --glass-border: 255 255 255;
}

html,
body,
#root {
  height: 100%;
}

body {
  margin: 0;
  min-width: 320px;
  background: transparent;
  color: rgb(var(--fg));
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial,
    'Apple Color Emoji', 'Segoe UI Emoji';
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  /* 移动端触摸优化 */
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  /* 安全区域适配（刘海屏/底部条） */
  padding-top: env(safe-area-inset-top);
}

@layer components {
  .glass-panel {
    @apply bg-glass/15 backdrop-blur-xl border border-glass-border/20;
  }

  .glass-panel-strong {
    @apply bg-glass/20 backdrop-blur-2xl border border-glass-border/25;
  }

  /* 带主题色边框的模态框面板 */
  .glass-modal {
    @apply bg-glass/20 backdrop-blur-2xl shadow-glass;
    border: 1px solid rgb(var(--primary) / 0.35);
  }

  .focus-ring {
    @apply outline-none ring-2 ring-primary/60 ring-offset-2 ring-offset-transparent;
  }
  
  /* 性能优化：GPU 加速提示 */
  .gpu-accelerate {
    transform: translateZ(0);
    backface-visibility: hidden;
  }
  
  /* 动画元素 will-change 提示 */
  .will-animate {
    will-change: transform, opacity;
  }
  
  /* 移动端毛玻璃优化：减少模糊层级 */
  @media (max-width: 768px) {
    .glass-panel,
    .glass-panel-strong {
      @apply backdrop-blur-lg; /* 从 xl/2xl 降级到 lg */
    }
    
    .glass-modal {
      @apply backdrop-blur-lg;
    }
  }
}


/* =========================
   流光边框效果（Glow Border）
   说明：搜索框聚焦时显示流光边框效果
   使用 conic-gradient + 伪元素 + mask 实现
   ========================= */

@property --glow-angle {
  syntax: "<angle>";
  inherits: false;
  initial-value: 0deg;
}

/* 流光边框容器 */
.glow-border {
  position: relative;
  z-index: 0;
}

/* ::after - 清晰的边框线条 */
.glow-border::after {
  --glow-angle: 0deg;
  content: "";
  position: absolute;
  inset: 0;
  z-index: -1;
  border-radius: inherit;
  /* 边框粗细 2px */
  padding: 2px;
  background: conic-gradient(
    from var(--glow-angle),
    transparent 50%,
    rgb(var(--primary) / 0.1) 60%,
    rgb(var(--primary) / 0.3) 70%,
    rgb(var(--primary) / 0.6) 80%,
    rgb(var(--primary) / 0.9) 90%,
    rgb(var(--primary)) 100%
  );
  /* 使用 mask 裁切内部，只保留边框 */
  -webkit-mask: 
    linear-gradient(#fff 0 0) content-box, 
    linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask: 
    linear-gradient(#fff 0 0) content-box, 
    linear-gradient(#fff 0 0);
  mask-composite: exclude;
  opacity: 0;
  transition: opacity 0.3s ease;
}

/* 激活状态 - 显示流光边框 */
.glow-border-active::after {
  opacity: 1;
  animation: glow-spin 4s linear infinite;
}

/* 外发光效果 - 移动模式（独立于流光线条） */
.glow-light-move {
  animation: glow-shadow 4s linear infinite !important;
}

/* 外发光效果 - 静态模式，像灯泡在背后照亮整个边框（独立于流光线条） */
.glow-light-static {
  box-shadow: 
    0 0 20px 2px rgb(var(--primary) / 0.4),
    0 0 40px 4px rgb(var(--primary) / 0.2) !important;
}

@keyframes glow-spin {
  from {
    --glow-angle: 0deg;
  }
  to {
    --glow-angle: 360deg;
  }
}

/* 外发光动画 - 模拟灯光从边框向外照射 */
/* conic-gradient 从 0deg (右侧/3点钟方向) 开始顺时针旋转 */
/* 流星头部在 100% 位置，所以 0deg 时头部在右侧 */
@keyframes glow-shadow {
  0% {
    /* 0deg: 流星头部在右侧 */
    box-shadow: 
      12px 0 20px -5px rgb(var(--primary) / 0.5),
      8px 0 10px -3px rgb(var(--primary) / 0.3) !important;
  }
  25% {
    /* 90deg: 流星头部在下方 */
    box-shadow: 
      0 12px 20px -5px rgb(var(--primary) / 0.5),
      0 8px 10px -3px rgb(var(--primary) / 0.3) !important;
  }
  50% {
    /* 180deg: 流星头部在左侧 */
    box-shadow: 
      -12px 0 20px -5px rgb(var(--primary) / 0.5),
      -8px 0 10px -3px rgb(var(--primary) / 0.3) !important;
  }
  75% {
    /* 270deg: 流星头部在上方 */
    box-shadow: 
      0 -12px 20px -5px rgb(var(--primary) / 0.5),
      0 -8px 10px -3px rgb(var(--primary) / 0.3) !important;
  }
  100% {
    /* 360deg: 回到右侧 */
    box-shadow: 
      12px 0 20px -5px rgb(var(--primary) / 0.5),
      8px 0 10px -3px rgb(var(--primary) / 0.3) !important;
  }
}

/* =========================
   右键菜单弹出动画
   ========================= */

/* 淡入动画 */
@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* 菜单展开动画 - 从点击点展开 */
@keyframes menuExpand {
  from {
    opacity: 0;
    transform: scale(0);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* 菜单收起动画 - 收回点击点 */
@keyframes menuCollapse {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(0);
  }
}

/* 淡出动画 */
@keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

/* =========================
   对话框缓入缓出动画
   ========================= */

/* 对话框弹入动画 - 从底部缩放弹入 */
@keyframes modalIn {
  from {
    opacity: 0;
    transform: scale(0.95) translateY(10px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

/* 对话框弹出动画 - 缩放淡出 */
@keyframes modalOut {
  from {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
  to {
    opacity: 0;
    transform: scale(0.95) translateY(10px);
  }
}

/* 背景遮罩淡入 */
@keyframes backdropIn {
  from {
    opacity: 0;
    backdrop-filter: blur(0px);
  }
  to {
    opacity: 1;
    backdrop-filter: blur(4px);
  }
}

/* 背景遮罩淡出 */
@keyframes backdropOut {
  from {
    opacity: 1;
    backdrop-filter: blur(4px);
  }
  to {
    opacity: 0;
    backdrop-filter: blur(0px);
  }
}

/* 应用类 */
.modal-enter {
  animation: modalIn 200ms cubic-bezier(0.32, 0.72, 0, 1) forwards;
}

.modal-exit {
  animation: modalOut 150ms cubic-bezier(0.32, 0.72, 0, 1) forwards;
}

.backdrop-enter {
  animation: backdropIn 200ms ease-out forwards;
}

.backdrop-exit {
  animation: backdropOut 150ms ease-in forwards;
}

/* 移动端设置页面滑动动画 */
@keyframes slideInFromRight {
  from {
    opacity: 0;
    transform: translateX(30%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes slideInFromLeft {
  from {
    opacity: 0;
    transform: translateX(-30%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.slide-in-right {
  animation: slideInFromRight 300ms cubic-bezier(0.32, 0.72, 0, 1) forwards;
}

.slide-in-left {
  animation: slideInFromLeft 300ms cubic-bezier(0.32, 0.72, 0, 1) forwards;
}

/* 移动端设置页面整体滑入/滑出动画 */
@keyframes slideUpIn {
  from {
    opacity: 0;
    transform: translateY(100%);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideDownOut {
  from {
    opacity: 1;
    transform: translateY(0);
  }
  to {
    opacity: 0;
    transform: translateY(100%);
  }
}

.slide-up-in {
  animation: slideUpIn 350ms cubic-bezier(0.32, 0.72, 0, 1) forwards;
}

.slide-down-out {
  animation: slideDownOut 250ms cubic-bezier(0.32, 0.72, 0, 1) forwards;
}

/* 桌面端设置弹窗动画 */
@keyframes scaleIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes scaleOut {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(0.95);
  }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes fadeOut {
  from { opacity: 1; }
  to { opacity: 0; }
}

.scale-in {
  animation: scaleIn 200ms cubic-bezier(0.32, 0.72, 0, 1) forwards;
}

.scale-out {
  animation: scaleOut 150ms cubic-bezier(0.32, 0.72, 0, 1) forwards;
}

.fade-in {
  animation: fadeIn 200ms ease-out forwards;
}

.fade-out {
  animation: fadeOut 150ms ease-in forwards;
}

/* =========================
   自定义滚动条样式
   说明：与毛玻璃背景一致的滚动条，全局适用
   ========================= */

/* Webkit 浏览器（Chrome、Safari、Edge） */
::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: rgb(var(--glass-border) / 0.3);
  border-radius: 5px;
  border: 2px solid transparent;
  background-clip: padding-box;
}

::-webkit-scrollbar-thumb:hover {
  background: rgb(var(--glass-border) / 0.5);
  border: 2px solid transparent;
  background-clip: padding-box;
}

::-webkit-scrollbar-corner {
  background: transparent;
}

/* Firefox */
* {
  scrollbar-width: thin;
  scrollbar-color: rgb(var(--glass-border) / 0.3) transparent;
}

/* 可选：为特定容器添加更细的滚动条 */
.scrollbar-thin::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

.scrollbar-thin::-webkit-scrollbar-thumb {
  border-radius: 3px;
  border: 1px solid transparent;
}
